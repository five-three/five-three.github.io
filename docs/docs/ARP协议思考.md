# ARP协议思考

> [TCP/IP: 在广域网（外网）上传输数据时会用到ARP协议吗？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/49337715?sort=created)

arp协议只工作在二层网络

同一网段下，通过交换机相连的网络，通过arp广播获取mac互相通信

不同网段下，发送者只需知道路由器的mac，将数据包发送给路由器就不管了，路由器会根据ip把包发到目标

> 假设我现在要给 车小胖 发hello。这里有两种情况。情况一：我与小胖位于同一子网。我向小胖的ip地址发起arp请求，小胖收到回应，告诉我他的mac地址，然后我向该mac地址发送hello即可。情况二：我与小胖不在同一子网。由于不在同一子网，我需要向我的网关发送arp请求，网关告诉我mac地址，然后我向告诉网关：“向小胖的ip发hello”。剩下的事情，我就不用管了，如果网络可达，那么小胖就会收到我发的hello。